<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WoW DPS Spin-the-Wheel</title>
<style>
    body {
        background-color: #16161d;
        color: white;
        text-align: center;
        font-family: Arial, sans-serif;
    }
    .wheel-container {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin-top: 30px;
    }
    .wheel-wrapper {
        position: relative;
    }
    canvas {
        background: #222;
        border-radius: 50%;
    }
    .arrow {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-left: 15px solid transparent;
        border-right: 15px solid transparent;
        border-bottom: 25px solid yellow;
        transform: translate(-50%, -135px);
    }
    button {
        margin: 10px;
        padding: 10px 20px;
        background: #007bff;
        border: none;
        border-radius: 8px;
        color: white;
        cursor: pointer;
        font-size: 16px;
    }
    button:hover {
        background: #0056b3;
    }
</style>
</head>
<body>

<h1>WoW DPS Spin-the-Wheel</h1>
<div class="wheel-container">
    <div class="wheel-wrapper">
        <div class="arrow"></div>
        <canvas id="wheel1" width="250" height="250"></canvas>
    </div>
    <div class="wheel-wrapper">
        <div class="arrow"></div>
        <canvas id="wheel2" width="250" height="250"></canvas>
    </div>
    <div class="wheel-wrapper">
        <div class="arrow"></div>
        <canvas id="wheel3" width="250" height="250"></canvas>
    </div>
</div>

<div>
    <button onclick="spinWheel(1)">Spin #1: DPS Type</button>
    <button onclick="spinWheel(2)">Spin #2: Class</button>
    <button onclick="spinWheel(3)">Spin #3: Spec</button>
</div>

<p id="result1"></p>
<p id="result2"></p>
<p id="result3"></p>

<script>
const dpsTypes = ["Caster DPS", "Melee DPS", "Ranged DPS"];
const classesByType = {
    "Caster DPS": ["Mage", "Warlock", "Shaman", "Priest", "Druid", "Evoker"],
    "Melee DPS": ["Warrior", "Rogue", "Paladin", "Death Knight", "Demon Hunter", "Monk", "Druid", "Shaman"],
    "Ranged DPS": ["Hunter", "Mage", "Warlock", "Shaman", "Evoker"]
};
const specsByClass = {
    "Mage": ["Fire", "Frost", "Arcane"],
    "Warlock": ["Affliction", "Demonology", "Destruction"],
    "Shaman": ["Elemental", "Enhancement"],
    "Priest": ["Shadow"],
    "Druid": ["Balance", "Feral"],
    "Evoker": ["Devastation"],
    "Warrior": ["Arms", "Fury"],
    "Rogue": ["Assassination", "Outlaw", "Subtlety"],
    "Paladin": ["Retribution"],
    "Death Knight": ["Frost", "Unholy"],
    "Demon Hunter": ["Havoc"],
    "Monk": ["Windwalker"],
    "Hunter": ["Beast Mastery", "Marksmanship", "Survival"]
};

const classColors = {
    "Warrior": "#C79C6E",
    "Paladin": "#F58CBA",
    "Hunter": "#ABD473",
    "Rogue": "#FFF569",
    "Priest": "#FFFFFF",
    "Death Knight": "#C41F3B",
    "Shaman": "#0070DE",
    "Mage": "#69CCF0",
    "Warlock": "#9482C9",
    "Monk": "#00FF96",
    "Druid": "#FF7D0A",
    "Demon Hunter": "#A330C9",
    "Evoker": "#33937F"
};

let wheel1Choice = null;
let wheel2Choice = null;

function drawWheel(canvasId, items, isClassWheel=false) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext("2d");
    const arc = (2 * Math.PI) / items.length;

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let i = 0; i < items.length; i++) {
        ctx.beginPath();
        ctx.fillStyle = isClassWheel && classColors[items[i]] ? classColors[items[i]] : (i % 2 === 0 ? "#ff4d4d" : "#ff6633");
        ctx.moveTo(125, 125);
        ctx.arc(125, 125, 125, i * arc, (i + 1) * arc);
        ctx.lineTo(125, 125);
        ctx.fill();
        ctx.save();
        ctx.translate(125, 125);
        ctx.rotate(i * arc + arc / 2);
        ctx.fillStyle = "white";
        ctx.textAlign = "right";
        ctx.font = "14px Arial";
        ctx.fillText(items[i], 115, 5);
        ctx.restore();
    }
}

function spinWheel(stage) {
    const canvas = document.getElementById(`wheel${stage}`);
    const ctx = canvas.getContext("2d");
    const items = stage === 1 ? dpsTypes :
                  stage === 2 ? classesByType[wheel1Choice] || [] :
                  stage === 3 ? specsByClass[wheel2Choice] || [] : [];
    if (!items.length) return;

    const arc = (2 * Math.PI) / items.length;
    const spinAngle = Math.random() * 2 * Math.PI + 10 * Math.PI;
    let angle = 0;
    const duration = 4000;
    const start = performance.now();

    function animate(timestamp) {
        const progress = Math.min((timestamp - start) / duration, 1);
        const easedProgress = 1 - Math.pow(1 - progress, 3);
        angle = easedProgress * spinAngle;
        ctx.setTransform(1, 0, 0, 1, 0, 0);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.translate(125, 125);
        ctx.rotate(angle);
        ctx.translate(-125, -125);
        drawWheel(`wheel${stage}`, items, stage === 2);

        if (progress < 1) {
            requestAnimationFrame(animate);
        } else {
            const selectedIndex = Math.floor(((2 * Math.PI) - (angle % (2 * Math.PI))) / arc) % items.length;
            const result = items[selectedIndex];
            if (stage === 1) {
                wheel1Choice = result;
                document.getElementById("result1").innerText = `Spin #1 Result: ${result}`;
                drawWheel("wheel2", classesByType[result], true);
            }
            if (stage === 2) {
                wheel2Choice = result;
                document.getElementById("result2").innerText = `Spin #2 Result: ${result}`;
                drawWheel("wheel3", specsByClass[result]);
            }
            if (stage === 3) {
                document.getElementById("result3").innerText = `Spin #3 Result: ${result}`;
            }
        }
    }

    requestAnimationFrame(animate);
}

drawWheel("wheel1", dpsTypes);
drawWheel("wheel2", []);
drawWheel("wheel3", []);
</script>
</body>
</html>
